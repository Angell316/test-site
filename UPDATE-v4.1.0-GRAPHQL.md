# üéØ v4.1.0 - Shikimori GraphQL API Integration

## ‚ú® –û—Å–Ω–æ–≤–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### üì∏ **–í–´–°–û–ö–û–ï –ö–ê–ß–ï–°–¢–í–û –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô!**

–ü–µ—Ä–µ—Ö–æ–¥ —Å REST API –Ω–∞ GraphQL API –ø–æ–∑–≤–æ–ª–∏–ª –ø–æ–ª—É—á–∏—Ç—å –ø–æ—Å—Ç–µ—Ä—ã –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ **–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º –∫–∞—á–µ—Å—Ç–≤–µ**!

#### –ö–∞—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–µ—Ä–æ–≤:

**REST API (—Å—Ç–∞—Ä–æ–µ):**
```
/system/animes/original/58426.jpg?1718266672
```

**GraphQL API (–Ω–æ–≤–æ–µ):**
```
/uploads/poster/animes/58426/main_2x-ada3d85205b582ae71576993a820b321.webp
```

### üîç –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:

#### 1. **–ù–æ–≤–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ GraphQL** (`lib/shikimoriGraphQL.js`)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç GraphQL —ç–Ω–¥–ø–æ–∏–Ω—Ç: `https://shikimori.one/api/graphql`
- ‚úÖ **–ü–æ—Å—Ç–µ—Ä—ã –≤ 2x —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏** (`main2xUrl`, `originalUrl`)
- ‚úÖ **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**: screenshots, poster2x
- ‚úÖ –ë–æ–ª–µ–µ –≥–∏–±–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ –ú–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- ‚úÖ Rate limiting: 5 req/sec (250ms –∏–Ω—Ç–µ—Ä–≤–∞–ª)

#### 2. **–£–ª—É—á—à–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö**

```javascript
{
  id: 58426,
  title: "–î–∞–Ω–º–∞—á–∏: –ú–µ–º–æ—Ä–∏—è –§—Ä–µ–∑",  // —Ä—É—Å—Å–∫–∏–π
  titleEn: "DanMachi: Memoria Freese",
  titleJp: "„ÉÄ„É≥„Åæ„Å° „É°„É¢„É™„Ç¢„Éª„Éï„É¨„Éº„Çº",
  
  // –í–´–°–û–ö–û–ï –ö–ê–ß–ï–°–¢–í–û:
  image: "https://shikimori.one/uploads/poster/animes/58426/main_2x-ada3d85205b582ae71576993a820b321.webp",
  poster2x: "https://shikimori.one/uploads/poster/animes/58426/main_2x-...",
  screenshots: [
    "https://shikimori.one/uploads/screenshots/.../original-...",
    // ... –±–æ–ª—å—à–µ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤
  ],
  
  description: "–ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ...",
  genre: ["–≠–∫—à–µ–Ω", "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", "–§—ç–Ω—Ç–µ–∑–∏"],
  rating: 7.8,
  episodes: 12,
  status: "–ó–∞–≤–µ—Ä—à—ë–Ω"
}
```

#### 3. **–û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**

–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –Ω–∞ GraphQL:
- ‚úÖ `app/page.js` - –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- ‚úÖ `app/anime/[id]/page.js` - –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- ‚úÖ `app/anime/page.js` - –∫–∞—Ç–∞–ª–æ–≥
- ‚úÖ `app/movies/page.js` - —Ñ–∏–ª—å–º—ã
- ‚úÖ `app/top/page.js` - —Ç–æ–ø
- ‚úÖ `components/Header.js` - –ø–æ–∏—Å–∫
- ‚úÖ `components/MoviesSection.js`
- ‚úÖ `components/GenresSection.js`
- ‚úÖ `app/data/animeData.js`

### üé® –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ GraphQL

1. **–ö–∞—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**
   - 2x —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ø–æ—Å—Ç–µ—Ä–æ–≤
   - WebP —Ñ–æ—Ä–º–∞—Ç (–º–µ–Ω—å—à–µ –≤–µ—Å, –ª—É—á—à–µ –∫–∞—á–µ—Å—Ç–≤–æ)
   - –î–æ—Å—Ç—É–ø –∫ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º
   - –°–∫—Ä–∏–Ω—à–æ—Ç—ã –≤ –≤—ã—Å–æ–∫–æ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏

2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
   - –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è
   - –ú–µ–Ω—å—à–µ —Ç—Ä–∞—Ñ–∏–∫–∞
   - –ë—ã—Å—Ç—Ä–µ–µ –∑–∞–≥—Ä—É–∑–∫–∞

3. **–ì–∏–±–∫–æ—Å—Ç—å**
   - –û–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –≤–º–µ—Å—Ç–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö
   - –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (related anime)
   - –§–∏–ª—å—Ç—Ä—ã –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ API

### üìä –î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–Ω–∏–º–µ:**
- `poster.originalUrl` - –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ø–æ—Å—Ç–µ—Ä
- `poster.mainUrl` - –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Å—Ç–µ—Ä
- `poster.main2xUrl` - –ø–æ—Å—Ç–µ—Ä –≤ 2x —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏ ‚≠ê **–ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø**
- `screenshots[].originalUrl` - —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º –∫–∞—á–µ—Å—Ç–≤–µ
- `screenshots[].x332Url` - —Å—Ä–µ–¥–Ω–∏–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã
- `screenshots[].x166Url` - –º–∞–ª–µ–Ω—å–∫–∏–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã

### üîß GraphQL Query Example

```graphql
query ($ids: String!) {
  animes(ids: $ids, limit: 1) {
    id
    name
    russian
    japanese
    score
    poster {
      originalUrl
      mainUrl
      main2xUrl  # <- 2x –∫–∞—á–µ—Å—Ç–≤–æ!
    }
    screenshots {
      originalUrl  # <- –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤
      x332Url
    }
    genres {
      russian
    }
    studios {
      name
    }
  }
}
```

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

```bash
cd anime-site
npm install
npm run dev
```

–û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3000

## üì¶ –í–µ—Ä—Å–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞

- **v1.0.0** - –ë–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è
- **v2.0.0** - –£–ª—É—á—à–µ–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω
- **v3.0.0** - Jikan API (MyAnimeList)
- **v3.0.1** - –°—Ç–∞–±–∏–ª—å–Ω–∞—è Jikan –≤–µ—Ä—Å–∏—è
- **v4.0.0** - Shikimori REST API
- **v4.1.0** - Shikimori GraphQL API ‚≠ê **–¢–ï–ö–£–©–ê–Ø**

### –û—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏:

```bash
# Jikan API (–∞–Ω–≥–ª. —è–∑—ã–∫)
git checkout v3.0.1

# Shikimori REST API (—Ä—É—Å. —è–∑—ã–∫, —Å—Ä–µ–¥–Ω–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ)
git checkout v4.0.0

# Shikimori GraphQL (—Ä—É—Å. —è–∑—ã–∫, –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ)
git checkout main
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **–í—Å–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ**
‚úÖ **–ü–æ—Å—Ç–µ—Ä—ã –≤ 2x —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏**
‚úÖ **–°–∫—Ä–∏–Ω—à–æ—Ç—ã –≤ –≤—ã—Å–æ–∫–æ–º –∫–∞—á–µ—Å—Ç–≤–µ**
‚úÖ **–ë—ã—Å—Ç—Ä–∞—è —Ä–∞–±–æ—Ç–∞ —Å GraphQL**
‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –æ—à–∏–±–∫–∏**

## üìö –ò—Å—Ç–æ—á–Ω–∏–∫–∏

- [Shikimori GraphQL Discussion](https://shikimori.one/clubs/950-shikimori-api/topics/594748-graphql)
- [Image Quality Discussion](https://shikimori.one/clubs/950-shikimori-api/topics/463771-nizkoe-kachestvo-anime-posterov)
- Shikimori API Documentation: https://shikimori.one/api/doc

---

**–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤! –ö–∞—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ! üá∑üá∫üéâ**

